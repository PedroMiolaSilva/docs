---
title: How to create and configure an edge function on your Edge Firewall
description: >-
  Edge functions are functions that run on the edge of the network, close to
  users. They can help you secure your applications through Edge Firewall.
meta_tags: firewall
namespace: documentation_how_to_edge_functions_firewall
meta_tag_robots_no_index: false
permalink: /documentation/products/guides/edge-functions/firewall/
---

import Tabs from '~/components/tabs/Tabs'
import InterfaceNote from '~/includes/snippets/InterfaceNote/en/snippet.mdx'

<InterfaceNote />

**Edge Functions** are functions that run on the edge of the network, close to users. They can help you secure your applications through Edge Firewall.

To use functions in your Edge Firewall, you have to go through two steps:

- Create an edge function.
- Configure the behaviors on the Edge Firewall page.

---

## Creating an edge function

<Tabs client:visible>
    <Fragment slot="tab.console">Console</Fragment>
    <Fragment slot="tab.rtm">Real-Time Manager</Fragment>

<Fragment slot="panel.console">
1. Access [Azion Console](/en/documentation/products/guides/how-to-access-azion-console/) > **Edge Functions**.
2. Click on **+ Edge Function**.
3. Choose a name for your function.
4. In the **Code** tab, write your edge function code, or simply paste it.
    - The edge function being used on the firewall must contain a *finishing event*, such as:

    ```js 
    addEventListener("firewall", (event) => {
        event.deny();
    });
    ```

5. Save it.

Now, your edge function can be used on an edge firewall configuration.
</Fragment>

<Fragment slot="panel.rtm">
1. On [Real-Time Manager (RTM)](https://manager.azion.com/), on the upper-left corner, select **Edge Functions** in the **Edge Libraries** section.
2. Click on **Add Function**.
3. Choose a name for your function.
4. Write your edge function code, or simply paste it.
    - The edge function being used on the firewall must contain a *finishing event*, such as:

    ```js 
    addEventListener("firewall", (event) => {
        event.deny();
    });
    ```

5. Save it.

Now, your edge function can be used on an edge firewall configuration.
</Fragment>

</Tabs>

---

## Configuring your edge function on the Edge Firewall 

After creating an edge function, you need to configure the edge firewall to use it.

### 2.1 Creating an edge firewall

<Tabs client:visible>
    <Fragment slot="tab.console">Console</Fragment>
    <Fragment slot="tab.rtm">Real-Time Manager</Fragment>

<Fragment slot="panel.console">
1. Access [Azion Console](/en/documentation/products/guides/how-to-access-azion-console/) > **Edge Firewall**.
2. Click on **+ Edge Firewall**.
3. Choose a name for the edge firewall.
4. Choose the domains you want to associate.
5. Enable the use of the **Edge Functions** module.
6. Activate the edge firewall and save it.

After saving the configuration, on the same page, the tabs **Functions Instances** and **Rules Engine** become available.
</Fragment>

<Fragment slot="panel.rtm">
1. On [Real-Time Manager (RTM)](https://manager.azion.com/), on the upper-left corner, select **Edge Firewall** in the **Secure** section.
2. Click on **Add Rule Set**.
3. Choose a name for the edge firewall.
4. Choose the domains you want to associate.
5. Enable the use of the **Edge Functions** module.
6. Activate the edge firewall and save it.

After saving the configuration, on the same page, the tabs **Functions** and **Rules Engine** become available.
</Fragment>

</Tabs>

### 2.2 Adding an edge function to the edge firewall

<Tabs client:visible>
    <Fragment slot="tab.console">Console</Fragment>
    <Fragment slot="tab.rtm">Real-Time Manager</Fragment>

<Fragment slot="panel.console">
1. Go to the **Functions Instances** tab.
2. Click the **+ Function Instance** button.
3. Give a name to your function instance.
4. Choose a **Edge Function**.
5. Click the **Save** button.
    - Only functions with the *Initiator Type* set as Edge Firewall are listed.
6. Go to the **Rules Engine** tab.
7. Select **+ Rules Engine**.
8. Write a name for the new rule.
9. Configure the criteria that will be applied.
10. Set the behavior to **Run Function** and select the function you want to run.
11. Click the **Save** button.
</Fragment>

<Fragment slot="panel.rtm">
1. Go to the **Functions** tab.
2. Select **Add Function**. 
3. Choose an **Instance Name**.
4. Choose a function.
5. Click the **Save** button.
    - Only functions with the *Initiator Type* set as Edge Firewall are listed.
6. Go to the **Rules Engine** tab.
7. Select **New Rule**.
8. Write a name for the new rule.
9. Configure the criteria that will be applied.
10. Set the behavior to **Run Function** and select the function you want to run.
11. Click the **Save** button.
</Fragment>

</Tabs>

:::note
It might take a while for your changes to propagate.
:::

---

## Automating Configuration with Azion's API and Terraform Provider

To automate the setup of edge applications and firewall rules, Azion provides integration with its API and a Terraform Provider.

### Using Azion's API

1. Access the [Azion API Documentation](https://www.azion.com/en/documentation/products/api/) to find detailed information on the available endpoints.
2. Authenticate your API requests using your credentials.
3. Use the API endpoints to create and configure edge functions and firewall rules programmatically.
   - For example, the API can be used to create edge functions, add them to the firewall, and set up rules.

### Utilizing Azion's Terraform Provider

1. Install Terraform and the Azion Terraform Provider by following the [installation guide](https://registry.terraform.io/providers/azion/azion/latest/docs).
2. Define your infrastructure as code using Terraform scripts.
3. Use the Azion Terraform Provider resources to automate the creation of edge functions and firewall configurations.
   - Specify the necessary configurations in `.tf` files and apply them using Terraform commands.

[TECHWRITER TODO: INSERT INFORMATION ABOUT HOW TO CONFIGURE SPECIFIC TEMPLATES AND EXAMPLES USING AZION'S API AND TERRAFORM PROVIDER]

By leveraging these tools, you can automate the process of setting up and managing your edge applications and firewall rules efficiently.
